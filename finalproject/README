Please note that the above code is publicly available at:
   https://gist.github.com/dgriff03/09da4ed25a651e1d6eb5
